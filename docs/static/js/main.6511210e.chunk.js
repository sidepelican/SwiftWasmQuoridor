(this["webpackJsonpquoridor-web"]=this["webpackJsonpquoridor-web"]||[]).push([[0],{31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n.n(c),r=n(22),s=n.n(r),a=(n(31),n(32),n(4)),o=n(3),l=(n(33),n(0)),u=Object(o.a)(Array(8)).flatMap((function(e,t){var n=t+1;return Object(o.a)(Array(8)).flatMap((function(e,t){var c=t+1;return[{x:n,y:c,o:"horizontal"},{x:n,y:c,o:"vertical"}]}))})),j=function(e){var t=e.game,n=e.wasm,i=Object(c.useState)(0),r=Object(a.a)(i,2)[1],s=Object(c.useCallback)((function(){r((function(e){return e+1}))}),[]),j=n.currentBoard(t),x="ai"===j.currentTurn;Object(c.useEffect)((function(){x&&setTimeout((function(){n.aiNext(t),s()}),50)}),[x,t,s,n]);var m=j.aiPawn.point,O=j.humanPawn.point,p=j.aiPawn.fencesLeft,y=j.humanPawn.fencesLeft,w="ai"===j.winner,v="human"===j.winner;return Object(l.jsxs)("div",{className:"Board",style:{position:"relative"},children:[Object(l.jsx)("div",{style:{display:"flex",flexDirection:"column",position:"absolute",top:"65px",left:"15px"},children:Object(o.a)(Array(9)).map((function(e,c){return Object(l.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:Object(o.a)(Array(9)).map((function(e,i){var r=j.canMoves[9*i+c],a=void 0;return r&&(a=function(){n.movePawn(t,{x:i,y:c}),s()}),Object(l.jsx)(f,{canMove:r,onClick:a},i)}))},c)}))}),Object(l.jsxs)("div",{children:[Object(l.jsx)(b,{isPlayer:!1,top:50*m.y+65,left:50*Math.floor(m.x)+15}),Object(l.jsx)(b,{isPlayer:!0,top:50*O.y+65,left:50*Math.floor(O.x)+15})]}),Object(l.jsx)("div",{children:u.map((function(e){var c,i,r,a,o=e.x,u=e.y,f=e.o;switch(f){case"horizontal":c=j.hFences[8*(o-1)+(u-1)].exists,i=j.hFences[8*(o-1)+(u-1)].canPut,a=50*(o-1),r=50*u;break;case"vertical":c=j.vFences[8*(o-1)+(u-1)].exists,i=j.vFences[8*(o-1)+(u-1)].canPut,a=50*o-10,r=50*(u-1)+10}r+=60,a+=20;var b=void 0;return i&&(b=function(){n.putFence(t,{x:o,y:u,orientation:f}),s()}),Object(l.jsx)(d,{orientation:f,canPlace:i,placed:c,top:r,left:a,onClick:b},"".concat(o,"_").concat(u,"_").concat(f))}))}),Object(l.jsxs)("div",{children:[Object(o.a)(Array(p)).map((function(e,t){return Object(l.jsx)(h,{top:10,left:15*t+10},t)})),Object(o.a)(Array(y)).map((function(e,t){return Object(l.jsx)(h,{top:540,left:15*t+10},t)}))]}),Object(l.jsxs)("div",{style:{position:"absolute",top:0,right:0},children:[x&&null==j.winner?Object(l.jsx)("p",{children:"AI thinking..."}):null,x||null!=j.winner?null:Object(l.jsx)("p",{children:"Your turn"})]}),Object(l.jsxs)("div",{style:{position:"absolute",bottom:0,right:0},children:[v?Object(l.jsx)("p",{children:"You Win"}):null,w?Object(l.jsx)("p",{children:"You Lose"}):null]})]})},f=function(e){return Object(l.jsx)("div",{className:"TileView"+(e.canMove?" canMove":""),onClick:e.onClick})},b=function(e){return Object(l.jsx)("div",{className:"PawnView"+(e.isPlayer?" isPlayer":""),style:{position:"absolute",top:e.top,left:e.left}})},d=function(e){return Object(l.jsx)("div",{className:"FenceView ".concat(e.orientation)+(e.canPlace?" canPlace":"")+(e.placed?" placed":""),style:{position:"absolute",top:e.top,left:e.left},onClick:e.onClick})},h=function(e){return Object(l.jsx)("div",{className:"MiniFenceView",style:{position:"absolute",top:e.top,left:e.left}})},x=n(23),m=n(6),O=n(13),p=n.n(O),y=n(24),w=n(25),v=n.n(w),g=n(26),_=n(14),k=n(15),S=function(){function e(t){Object(_.a)(this,e),this.rawMemory=void 0,this.rawMemory=t.memory}return Object(k.a)(e,[{key:"bytes",value:function(){return new Uint8Array(this.rawMemory.buffer)}},{key:"writeBytes",value:function(e,t){this.bytes().set(t,e)}}]),e}(),A=function(){function e(){Object(_.a)(this,e),this._instance=null,this._memory=null,this._nextArgument=null,this._nextReturn=null,this.textDecoder=new TextDecoder("utf-8"),this.textEncoder=new TextEncoder}return Object(k.a)(e,[{key:"setInstance",value:function(e){this._instance=e}},{key:"instance",get:function(){if(!this._instance)throw new Error("WebAssembly instance is not set yet");return this._instance}},{key:"memory",get:function(){return this._memory||(this._memory=new S(this.instance.exports)),this._memory}},{key:"callableKitImports",get:function(){var e=this;return{callable_kit:{receive_arg:function(t){e.memory.writeBytes(t,e._nextArgument),e._nextArgument=null},write_ret:function(t,n){var c=e.memory.bytes().subarray(t,t+n);e._nextReturn=e.textDecoder.decode(c)}}}}},{key:"callSwiftFunction",value:function(e,t){var n=this.instance.exports,c=JSON.stringify(t)+"\0",i=this.textEncoder.encode(c);console.debug("call swift function with",{functionID:e,argJsonString:c,argBytesLength:i.length}),this._nextArgument=i;var r=n.ck_send(e,i.length),s=this._nextReturn;switch(this._nextReturn=null,r){case 0:return JSON.parse(s);case 1:throw new Error(s)}}}]),e}(),P=function(e){return{newGame:function(){return e.callSwiftFunction(0,{})},putFence:function(t,n){return e.callSwiftFunction(1,{_0:t,_1:n})},movePawn:function(t,n){return e.callSwiftFunction(2,{_0:t,_1:n})},aiNext:function(t){return e.callSwiftFunction(3,{_0:t})},currentBoard:function(t){return e.callSwiftFunction(4,{_0:t})},deleteGame:function(t){return e.callSwiftFunction(5,{_0:t})}}},F=new g.a,N=new y.a({args:[],env:{},bindings:Object(m.a)(Object(m.a)({},v.a),{},{fs:F.fs})}),C=function(){var e=Object(x.a)(p.a.mark((function e(){var t,n,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new A,e.next=3,WebAssembly.compileStreaming(fetch("./WasmLib.wasm"));case 3:return n=e.sent,e.next=6,WebAssembly.instantiate(n,Object(m.a)(Object(m.a)({},N.getImports(n)),t.callableKitImports));case 6:return c=e.sent,t.setInstance(c),N.start(c),e.abrupt("return",P(t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=i.a.createContext(null),I=function(e){var t=Object(c.useState)(),n=Object(a.a)(t,2),i=n[0],r=n[1];return Object(c.useEffect)((function(){C().then(r)}),[]),null==i?Object(l.jsx)(l.Fragment,{children:e.children}):Object(l.jsx)(M.Provider,{value:i,children:e.children})},D=function(){var e,t=Object(c.useContext)(M),n=Object(c.useState)(void 0),i=Object(a.a)(n,2),r=i[0],s=i[1],o=Object(c.useCallback)((function(){null!=r&&null!=t&&(t.deleteGame(r),s(void 0))}),[r,t]);return Object(c.useEffect)((function(){null==r&&null!=t&&s(t.newGame())}),[r,t]),e=null==t?Object(l.jsx)("div",{className:"Board",style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:Object(l.jsxs)("p",{children:["Loading ",Object(l.jsx)("code",{children:".wasm"})," binary ..."]})}):null==r?Object(l.jsx)("div",{className:"Board",style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:Object(l.jsx)("p",{children:"Starting game ..."})}):Object(l.jsx)(j,{game:r,wasm:t}),Object(l.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e,Object(l.jsx)("button",{style:{width:"fit-content"},onClick:o,children:"Reset"})]})},B=function(){return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("h1",{children:Object(l.jsx)("code",{children:"Swift Quoridor!"})}),Object(l.jsx)(D,{}),Object(l.jsxs)("div",{className:"Description",children:[Object(l.jsx)("h2",{children:"Quoridor\uff08\u30b3\u30ea\u30c9\u30fc\u30eb\uff09"}),Object(l.jsx)("p",{children:"\u30bf\u30fc\u30f3\u5236\u306e\u30dc\u30fc\u30c9\u30b2\u30fc\u30e0\u3067\u3001\u81ea\u5206\u306e\u30b3\u30de\u3092\u76f8\u624b\u306e\u9663\u5730\uff08\u4e00\u756a\u4e0a\u307e\u305f\u306f\u4e00\u756a\u4e0b\u306e\u884c\uff09\u306b\u5230\u9054\u3055\u305b\u308b\u3068\u52dd\u5229\u3067\u3059\u3002 \u30bf\u30fc\u30f3\u30d7\u30ec\u30a4\u30e4\u30fc\u306f\u4ee5\u4e0b\u306e\u3069\u3061\u3089\u304b\u3092\u884c\u3048\u307e\u3059\u3002"}),Object(l.jsxs)("ul",{children:[Object(l.jsx)("li",{children:"\u30b3\u30de\u3092\u524d\u5f8c\u5de6\u53f31\u30de\u30b9\u306b\u52d5\u304b\u3059\u3002\u79fb\u52d5\u5148\u306b\u76f8\u624b\u306e\u30b3\u30de\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u98db\u3073\u8d8a\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002"}),Object(l.jsx)("li",{children:"\u677f\u30921\u679a\u8a2d\u7f6e\u3059\u308b\u3002\u677f\u306f\u30b3\u30de\u306e\u901a\u884c\u3092\u59a8\u5bb3\u3059\u308b\u3002\u30b3\u30de\u304c\u30b4\u30fc\u30eb\u3067\u304d\u306a\u304f\u306a\u308b\u3088\u3046\u306b\u677f\u3092\u8a2d\u7f6e\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u3044\u3002"})]}),Object(l.jsx)("h2",{children:"\u3053\u308c\u306f\u4f55\uff1f"}),Object(l.jsx)("p",{children:"Swift\u3067\u4f5c\u3063\u305f\u30b3\u30ea\u30c9\u30fc\u30eb\u306e\u30b2\u30fc\u30e0\u30a8\u30f3\u30b8\u30f3\u3092Wasm\u30d3\u30eb\u30c9\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u52d5\u304f\u3088\u3046\u306b\u3057\u305f\u3082\u306e\u3067\u3059\u3002"}),Object(l.jsx)("p",{children:"UI\u306fJS\u3067\u3059\u3002Swift\u3067\u306f\u30b2\u30fc\u30e0\u30a8\u30f3\u30b8\u30f3\u90e8\u5206\u3068AI\u304c\u52d5\u3044\u3066\u307e\u3059\u3002"}),Object(l.jsx)("hr",{style:{marginTop:"3rem"}}),Object(l.jsxs)("div",{style:{textAlign:"end"},children:["Twitter:",Object(l.jsx)("a",{className:"TwitterLink",href:"https://twitter.com/iceman5499",target:"_blank",rel:"noopener noreferrer",children:"@iceman5499"})]})]})]})};s.a.render(Object(l.jsx)(i.a.StrictMode,{children:Object(l.jsx)(I,{children:Object(l.jsx)(B,{})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.6511210e.chunk.js.map